---
title: "Randomization 2: Designing for common constraints & threats | *Randomisation 2: à traduire*"
author: "Alyssa René HEINZE"
date: "17-06-2023"
bibliography: ../learningdays-book.bib
biblio-style: apalike
link-citations: yes
colorlinks: yes
fig_caption: yes
header-includes: |
   \setbeamertemplate{footline}{\begin{beamercolorbox}{section in head/foot}
   \includegraphics[height=.5cm]{../Images/egap-logo.png} \hfill
   \insertframenumber/\inserttotalframenumber \end{beamercolorbox}}
   \usepackage{tikz}
   \usepackage{tikz-cd}
   \usepackage{textpos}
   \usepackage{booktabs,multirow,makecell}
output:
  beamer_presentation:
    keep_tex: true
    includes:
      in_header: columns.tex
    toc: true
    pandoc_args: [ "--toc" ]
    fig_caption: true
  revealjs::revealjs_presentation:
    fig_caption: true
    theme: default
    highlight: pygments
    center: false
    transition: fade
    smart: false
    self_contained: false
    reveal_plugins: ["notes", "search", "chalkboard"]
    pandoc_args: [ "--toc" ]
    reveal_options:
      slideNumber: true
      previewLinks: true
      chalkboard:
        theme: whiteboard
        toggleNotesButton: false
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
# source("rmd_setup.R")
# Load all the libraries we need
# library(here)
# library(tidyverse)
# library(kableExtra)
# library(DeclareDesign)
# library(estimatr)
# library(styler)
# library(coin)
# library(multcomp)
# library(devtools)
# library(randomizr)
# library(rcompanion) ## for pairwisePermutationTest()
```



## Key points for this lecture \| *Points clés*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

-   Randomization and design: What we've learned, what's next

-   Common constraints, more complex designs

-   Common threats, anticipatory designs

-   Final takeaway: Keep things simple

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   Vide pour l'instant.

-   

-  

:::
:::

# Randomization and design: What we've learned, what's next. \| *à traduire*

## Randomization and design:: What we've learned. \| *à traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
-   What we've covered:

    -   4 types of randomization: Simple, complete, block, and cluster
    -   And we can combine them: block-cluster, factorial designs

-   Most of the time these designs suffice.
    
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   
:::
:::

## Randomization and design:: What's next. \| *à traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
-   _BUT_ we often face:
    -   Practical constraints in our context
    -   Common threats to inference

-   *So* we need to take these into account in the _design_ of our experiment.
    -   How?
    -   Designing to take into account context-specific constraints:
        -   Waitlist designs, encouragement designs
    -   Designing to anticipate problems:
        -   Attrition, spillover
    
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   

:::
:::

# Common constraints, more complex designs. \| *à traduire*

## Common constraints \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
1. Constrained in how many units can be treated at one time
2. You can't force people to take your treatment
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
1.  a traduire
2.  pareil 
:::
:::


## More complex designs (1): Waitlist design \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
- Constraint: Only certain number of units can be treated at a time
- Solution: _Waitlist_ design


:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

1.  a.t.

    -   a.t.
    
:::
:::

## 1. Delayed access (Phase-in or wait list) \| Accès différé (Accès graduel ou liste d'attente)

\vspace{.03in}

![](../Images/delayed_access.png){width="280"}

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
-   When an intervention can be or must be rolled out in stages, you can
    randomize the order (*timing*) in which units are treated.

-   Your control group are the as-yet untreated units.
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   Lorsqu'une intervention peut ou doit être déployée par étapes, vous
    pouvez randomiser l'ordre (*timing*) de traitement des unités.

-   Votre groupe de contrôle sont les unités pas encore traitées.

:::
:::

## 1. Delayed access (Phase-in or wait list) \| Accès différé (Accès graduel ou liste d'attente)

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
-   Be careful: the probability of assignment to treatment will vary
    over time because units that are assigned to treatment in earlier
    stages are not eligible to be assigned to treatment in later stages.
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   Attention : la probabilité d'assignation au traitement variera dans
    le temps car les unités assignées au traitement à des stades
    antérieurs ne sont pas éligibles pour être assignées à un traitement
    à des stades ultérieurs.
:::
:::

## More complex designs (2): Encouragement design \| *à traduire.*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
- Constraint: You can't force people to take (receive) your treatment
- Solution: __Encouragement__ design

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
- a.t. 

:::
:::

## 2. Encouragement (planning for non-compliance) \| *Incitations*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
-   Randomize **encouragement** to take the treatment, such as a request
    to drink coffee or offering a subsidy to participate in a program.

-   Useful when you cannot force a subject to take the assigned
    treatment.

-   We can learn the average effect of the encouragement to take the
    treatment.
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   Randomisez l'**incitation** à suivre le traitement, en demandant par
    exmple aux individus de boire du café ou en offrant une subvention
    pour participer à un programme.

-   Utile lorsque vous ne pouvez pas forcer un sujet à participer.

-   Nous pouvons connaître l'effet moyen de l'encouragement à suivre le
    traitement.
:::
:::


## 2. Encouragement (planning for non-compliance) \| *Incitations*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
-   We can also learn the average effect of the taking the treatment
    \emph{for those subjects that would take the treatment when assigned to treatment and not take the treatment when assigned to control}.

-   But we need an additional assumption (exclusion restriction) and
    estimation is more complicated (instrumental variables).
:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}
-   Nous pouvons également connaître l'effet moyen de la prise du
    traitement
    \emph{pour les sujets qui prendraient le traitement lorsqu'ils sont assignés au traitement et qui ne prendraient pas le traitement lorsqu'ils sont assignés au contrôle (les conformistes)}.

-   Mais nous avons besoin d'une hypothèse supplémentaire (restriction
    d'exclusion) et l'estimation est plus compliquée avec l'assignation
    comme instrument.
:::
:::


# Common threats, anticipatory designs \| *a traduire*

## Common threats to inference \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

1.  Attrition: People do not respond to follow up surveys or are hard to find

2.  Spillover: The effects of a treatment may spill over from people treated to their neighbors, friends, or family members, making it hard to nail down the effect on any one person

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

1.  a.t

2.  a.t

:::
:::

## Anticipating threats via design (1): Attrition \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
- Challenge: Attrition
- Attention to this _important_
- Solution(s):
    - Pilot your approach to maximize chances of response
    - Plan (budget) to reach all subjects at endline
    - Plan (budget) for double-sampling to follow-up
    - Blind people to treatment status
    - Deliver treatment to control group post-research


:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## 1. Attrition: Why it matters \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

- Missing outcome data is problematic when:
    - Missingness is systematically associated with certain _types_ of outcomes, or with units' treatment assignment status

- The problem is this:
    - Without outcome data, can't analyze impact of treatment on outcomes
    - Can't just ignore the missing data
    - Treatment and control groups are no longer comparable
    - This breaks the "analyze as you randomize" principle


:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::


## 1. Attrition: When it can happen \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

- Kids who anticipate failing test miss the test
- Researcher effort: Control units more likely to be missing because researcher engaged less with them
- Data problems: elections results not reported for a certain region, people move away and they’re more difficult to track, people change phone numbers
- Responding to surveys is annoying to some people, or they’re busy when you approached them

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## 1. Attrition: Anticipating it in design \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

1. Pilot your approach: in pilot, figure out what works best to get responses
    - Different types of incentives?
    - Call versus in-person?
    - Best days or timings?

2. Plan to reach all subjects at endline
    - Budget for strong efforts (time, resources) to get responses

3. Plan for double-sampling
    - Budget for _intensive_ follow-up with random sample of attriters

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## 1. Attrition: Anticipating it in design \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

4. Blind people to their treatment status
    - Idea: people won't avoid follow-up if they know they're in control

5. Promise to deliver treatment to control post-research
    - Idea: people will remain engaged in the study even if in control

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## 1. Attrition: Anticipating it in design \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}


- NOTE: Keeping good records is crucial!
    - Treatment assignment status
    - Outcome variable as NA if missing
    - (By the way, here we're not talking about covariates)

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## Anticipating threats via design (2): Spillover \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}
- Challenge: Spillover
- Attention to this _important_
- Solution:
    - Keep units far apart


:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## 1. Spillover: Anticipating it in design \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}


- 

:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

# Final takeaway: Keep things simple \| *a traduire*

## Complex $\neq$ better! \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

- Complexity is possible, but simplicity is always preferred.
- People mistakenly think
    - Complex = sophisticated &rarr; better
- In fact, straightforward designs &rarr; better


:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::

## Keep things simple \| *a traduire*

::: {.cols data-latex=""}
::: {.col data-latex="{0.48\\textwidth}"}

- You now have more complex designs in your toolkit, but:
    - If you don't need them, don't use them

- Why? With simplicity:
    - Less can go wrong
    - More likely to notice when something does
    - Easier to understand design properties
    - Interpretability and communication of findings


:::

::: {.col data-latex="{0.04\\textwidth}"}
  <!-- an empty Div (with a white space), serving as
a column separator -->
:::

::: {.col data-latex="{0.48\\textwidth}"}

- A.t.
    
:::
:::


## Resource \| *Ressource*

-   EGAP Methods Guide on Randomization
    (<https://egap.org/resource/10-things-to-know-about-randomization/>)

-   EGAP Methods Guide on Missing Data
    (<https://egap.org/resource/10-things-to-know-about-missing-data/>)

-   Guide des méthodes EGAP sur la randomisation
    (<https://egap.org/fr/resource/10-choses-a-savoir-sur-la-randomisation/>)

-   Guide des méthodes EGAP sur les données manquantes
    (<https://egap.org/resource/10-things-to-know-about-missing-data/>)
